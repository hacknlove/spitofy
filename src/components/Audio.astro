---
import { getEntry } from "astro:content";

const track = await getEntry("tracks", "we will never die");
---

<audio
  autoplay
  id="audioGlobal"
  crossorigin="anonymous"
  transition:name="audioGlobal"
  transition:persist
  data-bmp={track.data.bpm}
>
  <source src={track.data.mp3} />
</audio>

<script>
  const audio = document.getElementById("audioGlobal") as HTMLMediaElement;
  audio.addEventListener("ended", () => {
    document.body.classList.remove("playing");
  });
  audio.addEventListener("play", () => {
    document.body.classList.add("playing");
  });
  audio.addEventListener("pause", () => {
    document.body.classList.remove("playing");
  });
</script>